<!DOCTYPE HTML>
<html>

  <head>
    <meta charset="UTF-8">
    <title>openintegrity-elm</title>
    <link type="text/css" rel="stylesheet" href="/main.css">
    <link type="text/css" rel="stylesheet" href="/todo.css">
    <script type="text/javascript" src="/Main.js"></script>
  </head>

  <body>
  </body>

  <script>
    var storedState = localStorage.getItem('metasphere-state');
    var startingState = storedState ? JSON.parse(storedState) : null;
    var oii = Elm.fullscreen(Elm.Main, { getStorage: startingState });
    oii.ports.focus.subscribe(function(selector) {
        setTimeout(function() {
            var nodes = document.querySelectorAll(selector);
            if (nodes.length === 1 && document.activeElement !== nodes[0]) {
                nodes[0].focus()
            }
        }, 50);
    });
    oii.ports.setStorage.subscribe(function(state) {
        localStorage.setItem('metasphere-state', JSON.stringify(state));
    });
  </script>

</html>